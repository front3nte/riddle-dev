<script setup lang="ts">
import router from '@/router'
import QuizApp from '../components/QuizApp.vue'
import { useLevelStore } from '../stores/quiz'
import { onMounted } from 'vue'

const levelStore = useLevelStore()
if (!levelStore.reached('final-riddle') && !(import.meta.env.VITE_SKIP_ALLOWED === 'true')) {
  router.push('/fantasy-quiz')
}

onMounted(() => {
  document.body.classList.remove(...levelStore.levels, 'start')
  document.body.classList.add('final-riddle')
})

const questions = [
  {
    q: `<code>
      <pre>
    function Ã¶ffnePortal({purpur, saphire, smaragte, goldunzen, rubine}) {
      function verwandlung(drachenblut) {
        return drachenblut.charCodeAt(0).toString()
      }

      function magie(feenstaub) {
        return feenstaub.charCodeAt(0).toString(16)
      }

      const [a, d, A, l] = purpur.map(verwandlung);
      const [n, G, f] = saphire.map(magie);
      const [h, e, s] = smaragte;
      const [k, L, g] = goldunzen.map(verwandlung);
      const [o, I, Ã¤] = rubine.map(magie);
      return n + "." + [G,a,n,d,A,l,f].join('') + ", " + h + "." + [k,L,e,g,o,I,Ã¤,s].join('');
    }

    var schlÃ¼ssel = {
      purpur: [ğŸŒ¿, ğŸ”®, ğŸ°, ğŸ—¡ï¸],
      saphire: [ğŸ¦„, ğŸ§™ğŸ¼â€â™‚ï¸, âœ¨],
      smaragte: [âš”ï¸, ğŸ‰, ğŸ²],
      goldunzen: [ğŸ¹, ğŸ§šâ€â™€, ğŸ“œ],
      rubine: [ğŸ“–, ğŸ§, ğŸ“š],
    }

    var magischeSequenz = Ã¶ffnePortal(schlÃ¼ssel);
    </pre>
    </code>

    Welche magische Sequenz offenbart euch das Portal, nachdem ihr alle auf eurer Reise gesammelten SchlÃ¼ssel in die passenden Vertiefungen eingesetzt habt?`,
    a: btoa(import.meta.env.VITE_GEO_ANSWER),
    e: 'ğŸŒŒ'
  }
]
</script>

<template>
  <main>
    <QuizApp
      :questions="questions"
      start-text="Tretet NÃ¤her!"
      level="final-riddle"
      heading="Willkommen am Portal von Wesoria"
    >
      <p>
        Mit dem Wissen und den Erkenntnissen, die ihr wÃ¤hrend eurer epischen Reise durch das Land
        gesammelt habt, steht ihr nun vor einem monumentalen, von magischem Leuchten durchzogenen
        Portal. Die Legenden sprechen davon, dass dieses Tor den letzten Hinweis zu eurer heiligen
        Mission beherbergt, aber es kann nicht von jedermann geÃ¶ffnet werden. Nur diejenigen, die
        die Geheimnisse des Landes entschlÃ¼sselt haben, kÃ¶nnen die Macht dieses Portals freisetzen.
      </p>
      <p>
        Vor euch findet ihr einen antiken Steinpfeiler, in den ein seltsames Pult mit mehreren
        Vertiefungen gemeiÃŸelt wurde. Jede dieser Vertiefungen scheint genau die Form eines der
        Symbole und Zahlen zu haben, die ihr wÃ¤hrend eurer Abenteuer entdeckt habt.
      </p>
      <p>
        FlÃ¼sternd durch die Luft hallen die Worte einer alten Sage: "Die Antworten, die ihr sucht,
        sind der SchlÃ¼ssel, den ihr besitzt. FÃ¼gt sie zusammen, vereint ihr Wissen und setzt sie in
        die richtige Reihenfolge, um die magische Sequenz zu vervollstÃ¤ndigen."
      </p>
      <p>
        WÃ¤hrend ihr die gesammelten Symbole und Zahlen in die Vertiefungen des Pults setzt, spÃ¼rt
        ihr, wie die Energie des Portals reagiert, jedes Mal stÃ¤rker werdend, wenn ein weiteres
        StÃ¼ck des Puzzles an seinen Platz gesetzt wird.
      </p>
      <p>
        Sobald alles an seinem Platz ist, sollt ihr die uralten Worte sprechen, die das Portal euch
        Offenbart. Wenn ihr richtig liegt, wird sich das Portal zum Turm des Palastes von Wesoria
        Ã¶ffnen und der letzte Hinweis wird euch enthÃ¼llt. Wenn nicht, muss das RÃ¤tsel von Neuem
        begonnen werden. Seid wachsam, denn eure Mission ist fast erfÃ¼llt. Es liegt nun an euch, die
        Antworten zu kombinieren und das Portal zu Ã¶ffnen.
      </p>
    </QuizApp>
  </main>
</template>

<style>
code {
  font-size: 12px;
}
</style>
